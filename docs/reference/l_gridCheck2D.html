<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Binning and checking GAM residuals — l_gridCheck2D • mgcViz</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">


<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>
  
  
<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">mgcViz</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/mgcviz.html">mgcViz: visual tools for GAMs</a>
    </li>
  </ul>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

      <div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Binning and checking GAM residuals</h1>
    </div>

    
    <p>This layer bins the residuals, r, according to the value of the corresponding
covariates, x1 and x2. Then the residuals in each bin are summarized using a
scalar-valued statistic. Confidence intervals for the statistic corresponding
to each bin can be obtained by simulating residuals from the fitted GAM
model, which are then binned and summarized. Mainly useful in conjuction with <a href='check2D.html'>check2D</a>.</p>
    

    <pre class="usage"><span class='fu'>l_gridCheck2D</span>(<span class='kw'>gridFun</span> <span class='kw'>=</span> <span class='no'>mean</span>, <span class='kw'>bw</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='fl'>NA</span>, <span class='fl'>NA</span>), <span class='kw'>stand</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>binFun</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='no'>...</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a> Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>gridFun</th>
      <td><p>scalar-valued function used to summarize the residuals in each bin.</p></td>
    </tr>
    <tr>
      <th>bw</th>
      <td><p>numeric vector giving bin width in the vertical and horizontal directions. See the <code>binwidth</code>
arguments in <code><a href='http://www.rdocumentation.org/packages/ggplot2/topics/stat_summary_2d'>?ggplot2::stat_summary_hex</a></code>. If left to <code>NA</code>, it will be set to 1/20
of the ranges of x1 and x2.</p></td>
    </tr>
    <tr>
      <th>stand</th>
      <td><p>if left to <code>TRUE</code> then the observed statistic in the i-th cell is normalized using
the simulated statistics in that same cell. That is, we will actually plot
<code>std_stat = (obs_stat-mean(sim_stat))/sd(sim_stat)</code>.</p></td>
    </tr>
    <tr>
      <th>binFun</th>
      <td><p>the <code>ggplot2</code> function used to perform the binning. By default it
is either <a href='http://www.rdocumentation.org/packages/ggplot2/topics/stat_summary_2d'>ggplot2::stat_summary_2d</a> or <a href='http://www.rdocumentation.org/packages/ggplot2/topics/stat_summary_2d'>ggplot2::stat_summary_hex</a>, depending
on which the class of the covariates x1 and x2.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>graphical arguments to be passed to <code><a href='http://www.rdocumentation.org/packages/ggplot2/topics/stat_summary_2d'>ggplot2::stat_summary_hex</a></code>.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>An object of class <code>gamLayer</code></p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><span class='co'># NOT RUN {</span>
<span class='fu'>library</span>(<span class='no'>mgcViz</span>);
<span class='fu'>set.seed</span>(<span class='fl'>4124</span>)
<span class='no'>n</span> <span class='kw'>&lt;-</span> <span class='fl'>1e4</span>
<span class='no'>x</span> <span class='kw'>&lt;-</span> <span class='fu'>rnorm</span>(<span class='no'>n</span>); <span class='no'>y</span> <span class='kw'>&lt;-</span> <span class='fu'>rnorm</span>(<span class='no'>n</span>);

<span class='co'># Residuals are heteroscedastic w.r.t. x</span>
<span class='no'>ob</span> <span class='kw'>&lt;-</span> (<span class='no'>x</span>)^<span class='fl'>2</span> + (<span class='no'>y</span>)^<span class='fl'>2</span> + (<span class='fl'>1</span>*<span class='fu'>abs</span>(<span class='no'>x</span>) + <span class='fl'>1</span>)  * <span class='fu'>rnorm</span>(<span class='no'>n</span>)
<span class='no'>b</span> <span class='kw'>&lt;-</span> <span class='fu'>bam</span>(<span class='no'>ob</span> ~ <span class='fu'>s</span>(<span class='no'>x</span>,<span class='kw'>k</span><span class='kw'>=</span><span class='fl'>30</span>) + <span class='fu'>s</span>(<span class='no'>y</span>, <span class='kw'>k</span><span class='kw'>=</span><span class='fl'>30</span>), <span class='kw'>discrete</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)
<span class='no'>b</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='getViz.html'>getViz</a></span>(<span class='no'>b</span>, <span class='kw'>nsim</span> <span class='kw'>=</span> <span class='fl'>50</span>)

<span class='co'># Don't see much by looking at mean</span>
<span class='fu'><a href='check2D.html'>check2D</a></span>(<span class='no'>b</span>, <span class='st'>"x"</span>, <span class='st'>"y"</span>) + <span class='fu'>l_gridCheck2D</span>(<span class='kw'>gridFun</span> <span class='kw'>=</span> <span class='no'>mean</span>, <span class='kw'>bw</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='fl'>0.4</span>, <span class='fl'>0.4</span>))

<span class='co'># Variance pattern along x-axis clearer now</span>
<span class='fu'><a href='check2D.html'>check2D</a></span>(<span class='no'>b</span>, <span class='st'>"x"</span>, <span class='st'>"y"</span>) + <span class='fu'>l_gridCheck2D</span>(<span class='kw'>gridFun</span> <span class='kw'>=</span> <span class='no'>sd</span>, <span class='kw'>bw</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='fl'>0.4</span>, <span class='fl'>0.4</span>))

<span class='co'># }</span></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Matteo Fasiolo, Raphael Nedellec.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  </body>
</html>
